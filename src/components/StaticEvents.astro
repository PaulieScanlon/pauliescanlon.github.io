---
export interface Props {
  /** The GitHub user name */
  username: string;
  /** The amount of results to display */
  results?: number;
}

const { username, results = 50 } = Astro.props;

const response = await fetch('https://paulieapi.gatsbyjs.io/api/get-github-user-events', {
  method: 'POST',
  body: JSON.stringify({
    username: username,
    results: results,
  })
});

const data = await response.json();
// console.log(JSON.stringify(data, null, 2));
import EventCard from './EventCard.tsx'
---


<div>
  <h2>StaticEvents | @{username}</h2>
  <pre>https://paulieapi.gatsbyjs.io/api/get-github-events</pre>
  <div>
      {
        data.events.map((event, index) => {
          const {type, actor,created_at,  repo, payload} = event
          return (
            <EventCard 
              key={index} 
              type={type} 
              date={created_at}
              login={actor.login}
              repo={repo} 
              commits={payload.commits}
            />
          )
        })
      }
  </div>
</div>